<?xml version="1.0" encoding="UTF-8"?>

<MACRO name="Insert padding for selected tracks" script="// This macro inserts padding at the beginning of selected tracks&#10;// This is necessary for the Groove Doctor not to shift clips&#10;// in tracks where there are spaces.&#10;// Usage: &#10;//   1. Select tracks in the track header.&#10;//   2. Execute the macro.&#10;&#10;function logTrack(track, i, clips)&#10;{&#10;    name = Tracktion.getName(track);&#10;    Tracktion.log(&quot;Track[&quot; + i + &quot;] = &quot; + name + &quot; has &quot; + clips.length + &quot; clips&quot;);&#10;}&#10;&#10;function padTracks(tracks, start)&#10;{&#10;    for(var t = 0; t &lt; tracks.length; ++t ) {&#10;        name = Tracktion.getName(tracks[t]);&#10;        Tracktion.log(&quot;Padding Track[&quot; + t + &quot;] name  (&quot; + name + &quot;)&quot;);&#10;        Tracktion.deselectAll();&#10;        Tracktion.addObjectsToSelection(tracks[t]);&#10;        Tracktion.setPosition ('cursor', start);&#10;        Tracktion.insertClip ('wave');&#10;    }&#10;}&#10;&#10;function mergeAllClips(tracks)&#10;{&#10;    Tracktion.deselectAll();&#10;    for(var t = 0; t &lt; tracks.length; ++t ) {&#10;        var clips = Tracktion.getClipsFromTracks (tracks[t]);&#10;        logTrack(tracks[t], t, clips);&#10;        for(var c = 0; c &lt; clips.length; ++c ) {&#10;            Tracktion.addObjectsToSelection(clips[c]);&#10;            var clipName = Tracktion.getName(clips[c]);&#10;            Tracktion.log(&quot;Processing Track &quot; + t + &quot;, clip &quot; + c + &quot; (&quot; + clipName + &quot;)&quot;);&#10;            if (clipName === 'New Audio Clip') {&#10;                var newName = Tracktion.getName(clips[c-1]);&#10;                Tracktion.log(&quot;Setting clip &quot; + c + &quot; name to (&quot; + newName + &quot;)&quot;);&#10;                Tracktion.setName (clips[c], newName);&#10;            }&#10;        } &#10;    }&#10;    // Even though we have selected all clips, merge processing is per track&#10;    Tracktion.mergeSelectedClips (true);&#10;}&#10;&#10;function selectedTracksPadding() {&#10; var tracks   = Tracktion.getSelectedEditElements ('track');&#10;    if (tracks.length == 0) {&#10;        Tracktion.showMessage('No tracks selected');&#10;        return;&#10;    }&#10;    Tracktion.log(&quot;Selected &quot; + tracks.length + &quot; tracks&quot;);&#10;    padTracks(tracks, 0);&#10;    mergeAllClips(tracks);&#10;}&#10;&#10;selectedTracksPadding();&#10;"/>
